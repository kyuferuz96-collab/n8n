# n8n 解锁版 Docker Compose 环境变量配置
# 复制此文件为 .env 并填写实际值

# ============================================
# 🔐 必需配置
# ============================================

# Docker Hub 用户名（替换为你的用户名）
DOCKER_USERNAME=your-dockerhub-username

# 镜像版本标签（可选，默认 unlocked-latest）
N8N_VERSION=unlocked-latest

# 🤖 AI 配置
# ============================================

# API Key（必需 - 用于 AI Builder 直连 LLM）
N8N_AI_ANTHROPIC_KEY=your-api-key-here

# n8n 官方 AI Assistant 服务地址（可选，通常留空即可）
# 只有在你自建/代理 n8n AI Assistant Service 时才需要设置
N8N_AI_ASSISTANT_BASE_URL=

# 工作流生成器直连 LLM 的自定义 API Base URL（可选）
# - provider=anthropic: https://api.anthropic.com
# - provider=openai: https://api.openai.com/v1  或  https://api.moonshot.cn/v1
# 说明：即使你填成带完整路径（/v1/messages 或 /chat/completions），系统也会尽量自动纠正
N8N_AI_LLM_BASE_URL=

# 协议类型（可选，默认 anthropic）
# - anthropic: 使用 Claude 协议（自动补全 /v1/messages）
# - openai: 使用 OpenAI 协议（自动补全 /chat/completions）
# 注意：工作流生成（AI Builder）的多阶段 agent 目前对 Anthropic 兼容更好；openai 可能会更容易卡住或触发 step limit
N8N_AI_PROVIDER=anthropic

# 自定义模型名称（可选，留空则使用默认模型）
# 示例：
# - Moonshot: moonshot-v1-8k, moonshot-v1-32k, moonshot-v1-128k
# - OpenAI: gpt-4, gpt-3.5-turbo
# - Claude: claude-sonnet-4-5-20250929
N8N_AI_MODEL_NAME=

# 🔑 n8n 加密密钥（必需 - 用于加密凭证）
# 生成方式：openssl rand -hex 32
N8N_ENCRYPTION_KEY=your-random-32-character-encryption-key-here

# ============================================
# 🌐 网络配置
# ============================================

# n8n 访问地址
N8N_HOST=localhost
N8N_PROTOCOL=http
WEBHOOK_URL=http://localhost:5678/

# 监听地址（Docker 场景建议显式设为 IPv4）
# 默认值通常为 ::（IPv6），某些服务器上会导致 127.0.0.1 无法访问
N8N_LISTEN_ADDRESS=0.0.0.0

# 反向代理层数（影响 trust proxy / X-Forwarded-For 解析 / 限流）
# - 1：nginx -> n8n
# - 2：cloudflare -> nginx -> n8n
N8N_PROXY_HOPS=1

# 可选：显式指定 Editor 的外部访问 URL（建议在反代/HTTPS 场景设置）
# N8N_EDITOR_BASE_URL=https://n8n.yourdomain.com
N8N_EDITOR_BASE_URL=

# 如果使用域名和 HTTPS，修改为：
# N8N_HOST=n8n.yourdomain.com
# N8N_PROTOCOL=https
# WEBHOOK_URL=https://n8n.yourdomain.com/

# ============================================
# 🗄️ 数据库配置
# ============================================

# Postgres（用于持久化 n8n 数据：工作流/凭证/执行记录等）
POSTGRES_DB=n8n
POSTGRES_USER=n8n
POSTGRES_PASSWORD=change-this-to-a-strong-password

# ============================================
# 🌍 其他配置
# ============================================

# 时区设置
TIMEZONE=Asia/Shanghai

# 日志级别（debug, info, warn, error）
N8N_LOG_LEVEL=info

# ============================================
# 🎨 可选：OpenAI API（如果需要使用 OpenAI）
# ============================================

# OpenAI 协议的 API Key（当 N8N_AI_PROVIDER=openai 时使用）
# 未设置时会回退使用 N8N_AI_ANTHROPIC_KEY
N8N_AI_OPENAI_KEY=
